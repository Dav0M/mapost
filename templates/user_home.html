{% extends "header_template.html" %}
{% block head %}
{{ super() }}
<title> {{ user.name }}'s Profile </title>
<link rel="stylesheet" href="/static/css/user_home.css">
<script src="/static/js/delete.js"></script>
<script src="/static/js/user.js"></script>
{% endblock %}
{% block content %}

<div class="pure-g">
  <div class="pure-u-1 user-container">
    <div class="pure-g user-details">
      <div class="pure-u">
        <img width="64" height="64" class="user-img" src="{{ user.img }}">
      </div>
      <div class="pure-u user-name">
        <h1 class="user-name">{{ user.name }}</h1>
      </div>
    </div>
  </div>
  <div class="pure-u-3-5 post-container">
    {% if posts|length == 0 %}
    <h1>{{ user.name }} has no posts :</h1>
    {% else %}
    <div class="post-col-left">
      {% for i in range(posts| length) %}
      {% if i%2 == 0 %}
      <div class="pure-u-3-5" id="{{ posts[i]['id'] }}">
        <div class="post">
          <div class="post-author-img"><img class="author-img" src="{{ posts[i]['user_img'] }}"></div>
          <div class="post-author"><a>{{ posts[i]['name'] }}</a></div>
          {% if session.get('user_id') and session['user_id']['id'] == user.id %}
          <ul class="pure-menu-list">
            <div class="pure-menu pure-menu-horizontal pure-menu-has-children pure-menu-allow-hover">
              <button type="button" class="pure-button more-button">...</button>
              <ul class="pure-menu-children more-children">
                <li class="pure-menu-item">
                  <a class="pure-menu-link edit-button" href="/edit/{{ user.id }}?post={{ posts[i]['id'] }}">Edit</a>
                </li>
                <li class="pure-menu-item">
                  <a class="pure-menu-link delete-button" data-post-id="{{ posts[i]['id'] }}">Delete</a>
                </li>
              </ul>
          </ul>
          {% endif %}
          <div class="post-date">{{ posts[i]['time'] }}</div>
          <div class="post-content">{{ posts[i]['content'] }}</div>
          {% if posts[i].get('img') != '' %}
          <div class="post-image"><img class="images" src="data:image;base64,{{ posts[i]['img'] }}"></div>
          {% endif %}
          <!-- <div class="post-location">{{ posts[i]['geog'] }}</div> -->
          <div class="post-footer">
            <img
              src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-l-embassy+f74e4e({{posts[i]['lon']}},{{posts[i]['lat']}})/{{posts[i]['lon']}},{{posts[i]['lat']}},13.75,0,60/400x175?access_token=pk.eyJ1IjoianlrMTk5OTEyMjIiLCJhIjoiY2x0M2FqODhkMWdhZzJscDhsNnlzYTFyaCJ9.eSPui_SEdaclP0xtujBzvw"
              class="post-map">
          </div>
        </div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
    <div class="post-col-right">
      {% for i in range(posts| length) %}
      {% if i%2 != 0 %}
      <div class="pure-u-3-5" id="{{ posts[i]['id'] }}">
        <div class="post">
          <div class="post-author-img"><img class="author-img" src="{{ posts[i]['user_img'] }}"></div>
          <div class="post-author"><a>{{ posts[i]['name'] }}</a></div>
          {% if session.get('user_id') and session['user_id']['id'] == user.id %}
          <ul class="pure-menu-list">
            <div class="pure-menu pure-menu-horizontal pure-menu-has-children pure-menu-allow-hover">
              <button type="button" class="pure-button more-button">...</button>
              <ul class="pure-menu-children more-children">
                <li class="pure-menu-item">
                  <a class="pure-menu-link edit-button" href="/edit/{{ user.id }}?post={{ posts[i]['id'] }}">Edit</a>
                </li>
                <li class="pure-menu-item">
                  <a class="pure-menu-link delete-button" data-post-id="{{ posts[i]['id'] }}">Delete</a>
                </li>
              </ul>
          </ul>
          {% endif %}
          <div class="post-date">{{ posts[i]['time'] }}</div>
          <div class="post-content">{{ posts[i]['content'] }}</div>
          {% if posts[i].get('img') != '' %}
          <div class="post-image"><img class="images" src="data:image;base64,{{ posts[i]['img'] }}"></div>
          {% endif %}
          <!-- <div class="post-location">{{ posts[i]['geog'] }}</div> -->
          <div class="post-footer">
            <img
              src="https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-l-embassy+f74e4e({{posts[i]['lon']}},{{posts[i]['lat']}})/{{posts[i]['lon']}},{{posts[i]['lat']}},13.75,0,60/400x175?access_token=pk.eyJ1IjoianlrMTk5OTEyMjIiLCJhIjoiY2x0M2FqODhkMWdhZzJscDhsNnlzYTFyaCJ9.eSPui_SEdaclP0xtujBzvw"
              class="post-map">
          </div>
        </div>

      </div>
      {% endif %}
      {% endfor %}
    </div>
    {% endif %}
  </div>


  <div class="pure-menu pure-menu-horizontal pages">
    <ul class="pure-menu-list">
      {% if page > 1 %}
      <li class="pure-menu-item">
        <a href="/user/{{ user.id }}?page=1" class="pure-menu-link">First</a>
      </li>
      <li class="pure-menu-item page-back">
        <a href="/user/{{ user.id }}?page={{ page-1 }}" class="pure-menu-link">Back</a>
      </li>
      {% endif %}

      {% set startPage = page-2 if page-2 > 0 else 1 %}
      {% set endPage = page+2 if page+2 <= total else total %} {% for p in range(startPage, endPage+1) %} <li
        class="pure-menu-item {{ 'page-curr' if p == page else '' }}">
        <a href="/user/{{ user.id }}?page={{ p }}" class="pure-menu-link">{{ p }}</a>
        </li>
        {% endfor %}

        {% if page < total %} <li class="pure-menu-item page-next">
          <a href="/user/{{ user.id }}?page={{ page+1 }}" class="pure-menu-link">Next</a>
          </li>
          <li class="pure-menu-item">
            <a href="/user/{{ user.id }}?page={{ total }}" class="pure-menu-link">Last</a>
          </li>
          {% endif %}
    </ul>
  </div>

</div>

{% endblock %}